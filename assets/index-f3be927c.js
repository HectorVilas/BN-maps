(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function t(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(e){if(e.ep)return;e.ep=!0;const n=t(e);fetch(e.href,n)}})();async function y(i){const t=await(await fetch(i)).json(),a={floors:[]},e=[];return t.forEach(n=>{e.includes(n.om_terrain)||e.push(n.om_terrain)}),e.forEach(()=>a.floors.push([])),t.forEach(n=>{const r=e.indexOf(n.om_terrain);a.floors[r].push(n)}),a}async function E(i,o,t){const a=o;(await(await fetch(`../../gfx/${i}/tile_config.json`)).json()).tile_info[0],t!=null&&t.palettes&&t.palettes.forEach(async r=>{console.log(r);let l;try{l=await fetch(`../../json/mapgen_palettes/${r}.json`)}catch(s){console.log(s)}const c=await l.json();console.log(c)});for(const r in a)Object.hasOwn(a,r)&&(a[r]="linear-gradient(45deg, darkgray, gray)");return a}async function g(i,o,t){var d,u,v;const a=document.createElement("div"),e=await i.floors[o][t],n=e.object.rows,r=n[0].length,l=n.length,c={};let s={};(d=e==null?void 0:e.object)!=null&&d.terrain&&(c.terrain=e.object.terrain),(u=e==null?void 0:e.object)!=null&&u.furniture&&(c.furniture=e.object.furniture),(v=e==null?void 0:e.object)!=null&&v.palettes&&(c.palettes=e.object.palettes),n.forEach(p=>{p.split("").forEach(m=>{s[m]={terrain:void 0,furniture:void 0,items:void 0,place_loot:void 0}})}),s=await E("BrownLikeBears",s,c);for(let p=0;p<l;p+=1){const m=document.createElement("div");m.classList.add("row");for(let h=0;h<r;h+=1){const b=e.object.rows[p][h],f=document.createElement("div");f.classList.add("tile"),f.dataset.x=h,f.dataset.y=p,f.textContent=`${b}`,f.style.background=s[b],m.append(f)}a.append(m)}return a}async function w(i,o){const t=i,a=[];return t.blueprint.floors.reverse().forEach((e,n)=>{const r=document.createElement("div");r.classList.add("floor-btn-div"),r.style.zIndex=n*-1;const l=document.createElement("p");if(l.classList.add("floor-om-terrain"),l.textContent=e[0].om_terrain,e.length>1){const s=document.createElement("span");s.textContent=` (${e.length} variants)`,l.append(s)}const c=document.createElement("div");if(c.classList.add("floor-btn"),c.value=l.textContent,c.value.includes("_roof")&&c.classList.add("roof"),c.value.includes("_basement")&&c.classList.add("basement"),[c,l].forEach(s=>{s.addEventListener("click",async()=>{const d=document.querySelector(`#${o}`);t.floor=n,t.variant=0,d.replaceChildren(await g(t.blueprint,t.floor,t.variant))})}),r.append(c,l),e.length>1){const s=document.createElement("div");s.classList.add("floor-btn-next"),s.textContent=">";const d=document.createElement("div");d.classList.add("floor-btn-prev"),d.textContent="<",s.addEventListener("click",async()=>{const u=document.querySelector(`#${o}`);t.floor!==n&&(t.variant=0),t.floor=n,t.variant+=1,e[t.variant]||(t.variant=0),u.replaceChildren(await g(t.blueprint,t.floor,t.variant))}),d.addEventListener("click",async()=>{const u=document.querySelector(`#${o}`);t.floor=n,t.variant-=1,e[t.variant]||(t.variant=e.length-1),u.replaceChildren(await g(t.blueprint,t.floor,t.variant))}),r.append(s,d)}a.push(r)}),a}async function j(i){const o={blueprint:[],floor:0,variant:0};o.blueprint=await y(i);const t=document.createElement("button");t.textContent="Back to list",t.addEventListener("click",()=>{window.location.reload()});const a=document.createElement("section"),e=document.createElement("div");e.id="map-viewer";const n=document.createElement("div");return n.id="map-floors",n.replaceChildren(...await w(o,e.id)),e.append(await g(o.blueprint,o.floor,o.variant)),a.append(t,e,n),a}const L=document.querySelector("#app");function x(){const i=document.createElement("main"),o=document.createElement("h1");o.textContent="BN Maps";const t=document.createElement("ul");return["./json/mapgen/house/2storymodern01.json","./json/mapgen/house/bungalow01.json","./json/mapgen/house/garden_house_1.json","./json/mapgen/house/house_garage_prepper.json","./json/mapgen/house/urban_1_house.json"].forEach(e=>{const n=document.createElement("li");n.textContent=e.split("/").at(-1).split(".json").at(0),n.addEventListener("click",async()=>{L.replaceChildren(await j(e))}),t.append(n)}),i.append(o,t),i}const _=document.querySelector("#app");_.append(x());
